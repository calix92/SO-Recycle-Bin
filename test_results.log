=== Starting Automated Tests ===

--- Recycle bin initialization ---
[0;32mRecycle bin initialized at /home/ruivo/.recycle_bin[0m
===============================================================
🗑️  Linux Recycle Bin Simulation — Help Menu
===============================================================

Usage:
  ./recycle_bin.sh <command> [arguments]

Commands:
  ─────────────────────────────────────────────────────────────
  delete <file(s)>          Move one or more files/directories to recycle bin
  list [--detailed]         List all items currently in recycle bin
  restore <id|name>         Restore a file by its unique ID or name
  search <pattern>          Search for files in recycle bin by name or pattern
  empty [<id>]              Empty the recycle bin (or delete a specific item)

  stats                     Display overall statistics (total size, count, etc.)
  auto_cleanup              Remove files older than RETENTION_DAYS (from config)
  check_quota               Check current recycle bin usage vs MAX_SIZE_MB
  preview <id>              Preview text content or type of a recycled file

  help | -h | --help        Show this help message
  version                   Display project version and author info
  --verbose                 Enable detailed output for debugging


Examples:
  ./recycle_bin.sh delete file.txt
  ./recycle_bin.sh delete file1.txt file2.txt
  ./recycle_bin.sh list --detailed
  ./recycle_bin.sh restore 1696234567_ab12cd
  ./recycle_bin.sh search ".pdf"
  ./recycle_bin.sh stats
  ./recycle_bin.sh check_quota
  ./recycle_bin.sh auto_cleanup
  ./recycle_bin.sh preview 1696234567_ab12cd
  ./recycle_bin.sh empty

Notes:
  • All operations are logged in ~/.recycle_bin/recyclebin.log
  • Metadata stored in ~/.recycle_bin/metadata.db
  • Configurable values (quota and retention) are in ~/.recycle_bin/config
  • Use quotes when dealing with filenames containing spaces.

===============================================================
:) PASS [1] Recycle bin initialized and help displayed
:) PASS [2] Recycle bin directory and metadata file exist

--- Delete a single file ---
[0;32m✓ Moved to recycle bin:[0m file1.txt (ID: 1761695087848793661_93z6uh)
:) PASS [3] File successfully moved to recycle bin

--- Delete multiple files ---
[0;32m✓ Moved to recycle bin:[0m file2.txt (ID: 1761695087893875164_5deki0)
[0;32m✓ Moved to recycle bin:[0m file3.txt (ID: 1761695087921603255_0wcku7)
:) PASS [4] Multiple files moved correctly

--- Delete directory recursively ---
[0;32m✓ Moved to recycle bin:[0m subdir (ID: 1761695087970281897_imyrc2)
:) PASS [5] Directory deleted correctly

--- List recycled contents ---
ID                        NAME                      DATE                 SIZE(B)   
--------------------------------------------------------------------------------
1761695087848793661_      file1.txt                 2025-10-28 23:44:47  7         
1761695087893875164_      file2.txt                 2025-10-28 23:44:47  0         
1761695087921603255_      file3.txt                 2025-10-28 23:44:47  0         
1761695087970281897_      subdir                    2025-10-28 23:44:47  4096      
:) PASS [6] List shows deleted files

--- Show statistics ---
=== Recycle Bin Statistics ===
Total items: 4
Total size: 4103 bytes (4.1K)
Files: 3 | Directories: 1
Oldest deletion: 2025-10-28 23:44:47
Newest deletion: 2025-10-28 23:44:47
Average size: 1025 bytes
===============================
:) PASS [7] Statistics command working

--- Search deleted file by name ---
=== Search Results for 'file1' ===
1761695087848793661_      file1.txt                 2025-10-28 23:44:47  7         
:) PASS [8] Search function returns expected result

--- Restore a file by ID ---
[0;32m✓ Restored:[0m /home/ruivo/OneDrive/1 SEMESTRE/SO/Projeto/SO-Recycle-Bin/test_data/file1.txt
:) PASS [9] File restored successfully

--- Restore with name conflict ---
[0;32m✓ Restored:[0m /home/ruivo/OneDrive/1 SEMESTRE/SO/Projeto/SO-Recycle-Bin/test_data/file2.txt
:) PASS [10] File restored with alternate name on conflict

--- Preview file (text) ---
[0;32m✓ Moved to recycle bin:[0m file1.txt (ID: 1761695088193598598_3mnxev)

--- Preview command ---
=== Preview of file1.txt (type: file) ===
secret
===============================
:) PASS [11] Preview command shows file content

--- Check storage quota ---
=== Storage Quota ===
Quota: 1024 MB
Used: 1 MB (0%)
[0;32mWithin safe limits.[0m
:) PASS [12] Quota check works

--- Auto cleanup old files ---
./recycle_bin.sh: line 336: retention: unbound variable
:) PASS [13] Old file cleaned automatically

--- Empty recycle bin (auto confirm) ---
[0;32mRecycle bin emptied successfully.[0m
:) PASS [14] Recycle bin emptied successfully

--- Delete nonexistent file ---
[0;31mError: File 'does_not_exist.txt' does not exist[0m
:) PASS [15] Handled nonexistent file correctly

--- Invalid command error ---
[0;31mInvalid command. Use 'help' for usage.[0m
:) PASS [16] Invalid command handled correctly

--- Restore without ID ---
[0;31mError: Must provide file ID or name[0m
:) PASS [17] Handled missing argument on restore

--- Verbose mode check ---
[1;33m[VERBOSE][0m Verbose mode activated
[1;33mRecycle bin is empty.[0m
:) PASS [18] Verbose mode handled gracefully

--- Display help ---
===============================================================
🗑️  Linux Recycle Bin Simulation — Help Menu
===============================================================

Usage:
  ./recycle_bin.sh <command> [arguments]

Commands:
  ─────────────────────────────────────────────────────────────
  delete <file(s)>          Move one or more files/directories to recycle bin
  list [--detailed]         List all items currently in recycle bin
  restore <id|name>         Restore a file by its unique ID or name
  search <pattern>          Search for files in recycle bin by name or pattern
  empty [<id>]              Empty the recycle bin (or delete a specific item)

  stats                     Display overall statistics (total size, count, etc.)
  auto_cleanup              Remove files older than RETENTION_DAYS (from config)
  check_quota               Check current recycle bin usage vs MAX_SIZE_MB
  preview <id>              Preview text content or type of a recycled file

  help | -h | --help        Show this help message
  version                   Display project version and author info
  --verbose                 Enable detailed output for debugging


Examples:
  ./recycle_bin.sh delete file.txt
  ./recycle_bin.sh delete file1.txt file2.txt
  ./recycle_bin.sh list --detailed
  ./recycle_bin.sh restore 1696234567_ab12cd
  ./recycle_bin.sh search ".pdf"
  ./recycle_bin.sh stats
  ./recycle_bin.sh check_quota
  ./recycle_bin.sh auto_cleanup
  ./recycle_bin.sh preview 1696234567_ab12cd
  ./recycle_bin.sh empty

Notes:
  • All operations are logged in ~/.recycle_bin/recyclebin.log
  • Metadata stored in ~/.recycle_bin/metadata.db
  • Configurable values (quota and retention) are in ~/.recycle_bin/config
  • Use quotes when dealing with filenames containing spaces.

===============================================================
:) PASS [19] Help command displays correctly
:) PASS [20] Metadata file consistent and valid
